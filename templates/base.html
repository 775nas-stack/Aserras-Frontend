<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ page_title }} • Aserras</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="{{ url_for('static', path='/css/style.css') }}" />
  </head>
  {% set raw_theme = request.cookies.get('aserras_theme', 'dark') %}
  {% set active_theme = 'light' if raw_theme == 'light' else 'dark' %}
  <body class="theme-{{ active_theme }}" data-theme="{{ active_theme }}">
    <header class="site-header">
      <div class="container header-inner">
        <a class="brand" href="/">Aserras</a>
        <button
          class="nav-toggle"
          type="button"
          aria-expanded="false"
          aria-label="Toggle navigation"
          data-nav-toggle
          aria-controls="site-nav"
        >
          <span></span><span></span><span></span>
        </button>
        <div class="nav-wrapper" data-nav-wrapper id="site-nav">
          <nav class="nav-primary" aria-label="Primary">
            <ul class="nav-links">
              <li>
                <a href="/" class="{% if nav_active == 'home' %}is-active{% endif %}">Home</a>
              </li>
              <li data-auth-visible="signed-out">
                <a href="/pricing" class="{% if nav_active == 'pricing' %}is-active{% endif %}">Pricing</a>
              </li>
              <li data-auth-visible="signed-out">
                <a href="/about" class="{% if nav_active == 'about' %}is-active{% endif %}">About</a>
              </li>
              <li data-auth-visible="signed-out">
                <a href="/contact" class="{% if nav_active == 'contact' %}is-active{% endif %}">Contact</a>
              </li>
              <li data-auth-visible="signed-in" hidden>
                <a href="/chat" class="{% if nav_active == 'chat' %}is-active{% endif %}">Chat</a>
              </li>
              <li data-auth-visible="signed-in" hidden>
                <a href="/image" class="{% if nav_active == 'image' %}is-active{% endif %}">Image</a>
              </li>
              <li data-auth-visible="signed-in" hidden>
                <a href="/code" class="{% if nav_active == 'code' %}is-active{% endif %}">Code</a>
              </li>
              <li data-auth-visible="signed-in" hidden>
                <a href="/history" class="{% if nav_active == 'history' %}is-active{% endif %}">History</a>
              </li>
              <li class="nav-auth nav-auth--login" data-auth-visible="signed-out">
                <a
                  class="nav-login{% if nav_active == 'login' %} is-active{% endif %}"
                  href="/login"
                  {% if nav_active == 'login' %}aria-current="page"{% endif %}
                >
                  <span class="nav-login__icon" aria-hidden="true"></span>
                  <span>Login</span>
                </a>
              </li>
              <li class="nav-auth nav-auth--cta" data-auth-visible="signed-out">
                <a
                  class="nav-cta{% if nav_active == 'signup' %} is-active{% endif %}"
                  href="/signup"
                  {% if nav_active == 'signup' %}aria-current="page"{% endif %}
                >
                  Start Now
                </a>
              </li>
            </ul>
          </nav>
          <div
            class="user-menu"
            data-user-menu
            data-auth-visible="signed-in"
            hidden
          >
            <button
              class="icon-button user-menu__trigger"
              type="button"
              aria-haspopup="true"
              aria-expanded="false"
              data-user-menu-toggle
            >
              <span class="sr-only">Open user menu</span>
              <span class="user-avatar" aria-hidden="true"></span>
            </button>
            <div class="user-menu__panel" role="menu" data-user-menu-panel>
              <div class="user-menu__group" data-visible-when="signed-in">
                <a role="menuitem" href="/dashboard">Dashboard</a>
                <a role="menuitem" href="/settings">Account</a>
                <a role="menuitem" href="/about">About</a>
                <a role="menuitem" href="/contact">Contact</a>
                <button type="button" role="menuitem" data-user-action="signout">Sign out</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main class="main-content">
      {% block content %}{% endblock %}
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <nav aria-label="Footer">
          <a href="/about">About</a>
          <a href="/contact">Contact</a>
          <a href="/terms">Terms</a>
          <a href="/privacy">Privacy</a>
        </nav>
        <p>© 2025 Aserras. All rights reserved.</p>
      </div>
    </footer>

    <script>
      (function () {
        const activeTheme = "{{ active_theme }}";
        const isAuthenticated = {{ 'true' if user else 'false' }};
        window.ASERRAS_CONFIG = {
          baseApiUrl: "",
          endpoints: {
            authLogin: "/api/auth/login",
            authSignup: "/api/auth/signup",
            authLogout: "/logout",
            chatSend: "/api/chat",
            imageGenerate: "/api/image",
            codeGenerate: "/api/code",
            userHistory: "/api/history",
            settingsProfile: "/api/settings/profile",
            settingsTheme: "/api/settings/theme",
          },
          brain: {
            base: "{{ settings.main_brain_base_url }}",
            pricing: "{{ settings.brain_api_pricing }}",
            models: "{{ settings.brain_api_content_policies }}",
          }
        };
        window.ASERRAS_UI_STATE = Object.assign({}, window.ASERRAS_UI_STATE || {}, {
          isAuthenticated,
          theme: activeTheme,
        });
      })();
    </script>
    <script src="{{ url_for('static', path='/js/config.js') }}" defer></script>
    <script src="{{ url_for('static', path='/js/main.js') }}" defer></script>
    {% block scripts %}{% endblock %}
  </body>
</html>
